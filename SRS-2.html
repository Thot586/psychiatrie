<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>SRS - Échelle de Réciprocité Sociale (Version Adulte - Rapport par un proche)</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap');
    :root{
      --primary:#0f62fe; --primary-light: #4f8aff; --primary-weak:#eef4ff; --text:#1f2937; --muted:#6b7280;
      --bg:#f7f7fb; --paper:#ffffff; --border:#e5e7eb; --ok:#16a34a; --danger: #dc3545; --warning: #ffc107;
      --warning-bg: #fffbeb; --warning-border: #fde68a; --warning-text: #b45309;
      font-size:16px;
    }
    *{box-sizing:border-box;margin:0;padding:0}
    html { scroll-behavior: smooth; }
    body{font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto; background:var(--bg); color:var(--text); line-height:1.6; padding:1rem}
    .container{max-width:54rem; margin:1rem auto; background:var(--paper); border:1px solid var(--border); border-radius:14px; box-shadow:0 8px 24px rgba(0,0,0,.06); overflow:hidden}
    
    header{background: linear-gradient(135deg, var(--primary), var(--primary-light)); color:#fff; padding:1.1rem 1.5rem}
    header h1{font-size:clamp(1.35rem,3.5vw,1.75rem); font-weight:700}
    .toolbar{display:flex; gap:.6rem; flex-wrap:wrap; align-items:center; margin-top:.5rem}
    
    /* Style par défaut pour les boutons (ex: Exporter) */
    .btn {
      background: #374151; /* Gris foncé */
      color: #fff;
      border: none;
      padding: .55rem .9rem;
      border-radius: 10px;
      cursor: pointer;
      transition: background-color .2s;
    }
    .btn:hover {
      background: #4b5563; /* Gris plus clair au survol */
    }

    /* Style spécifique pour les boutons dans l'en-tête (ex: Importer) */
    header .btn {
      background: rgba(255,255,255,0.15);
      border: 1px solid rgba(255,255,255,0.3);
    }
    header .btn:hover {
      background: rgba(255,255,255,0.25);
    }
    
    .btn[disabled]{opacity:.45; cursor:not-allowed}

    .section{padding:1rem 1.5rem; border-top:1px solid var(--border)}
    .instructions{background:var(--warning-bg); border-color:var(--warning-border); color:var(--warning-text);}
    
    .question{padding:1.25rem 0; border-bottom:1px solid var(--border); transition: background-color .3s;}
    .question.missing { background-color: #fef2f2; border-left: 4px solid var(--danger); padding-left: 1.5rem; }
    .qtext{font-weight:600; margin-bottom:1rem; font-size:1.05rem;}
    
    .opts-scale-srs { display: grid; grid-template-columns: repeat(4, 1fr); gap: .5rem; }
    .opts-scale-srs input[type="radio"] { display: none; }
    .opts-scale-srs label {
      text-align: center; padding: .7rem .4rem; cursor: pointer; border: 1px solid var(--border);
      background: #f8f9fa; border-radius: 8px; transition: .2s; font-weight: 500;
    }
    .opts-scale-srs label:hover{border-color:var(--primary); background:var(--primary-weak)}
    .opts-scale-srs input[type="radio"]:checked+label{background:var(--primary); color:#fff; border-color:var(--primary); box-shadow:0 6px 16px rgba(15,98,254,.25)}

    .actions{display:flex; flex-wrap:wrap; gap:.75rem; align-items:center; justify-content:center; margin-top:.8rem}
    button.primary{background: linear-gradient(135deg, var(--primary), var(--primary-light)); color:#fff; border:none; padding:.8rem 1.2rem; border-radius:10px; font-weight:700; cursor:pointer}
    .validation{color:#b91c1c; text-align:center; font-weight:600; display:none}

    /* --- Résultats --- */
    #results{display:none}
    #results .grid{display:grid; gap:1rem; grid-template-columns:1fr}
    .panel{border:1px solid var(--border); border-radius:12px; padding:1rem}
    .panel h3{font-size:1.05rem; margin-bottom:.25rem}
    .bigscore{display:flex; align-items:baseline; gap:.5rem; font-weight:800; font-size:2.1rem}
    .bigscore small{font-size:1rem; color:var(--muted); font-weight:600}
    
    .barwrap{margin-top:.55rem; margin-bottom:1.5rem;}
    .bar{height:.75rem; width:100%; background-image: linear-gradient(to right, var(--primary-weak), var(--primary)); border-radius:999px; position:relative;}
    .fill-marker{
        position: absolute; top: -.2rem; transform: translateX(-50%);
        width: .5rem; height: 1.15rem; background: #fff; border: 2px solid var(--text);
        border-radius: .25rem; z-index: 2; transition: left .6s ease;
    }
    .tick{position:absolute; top:-.35rem; width:2px; height:1.45rem; background:#111827; opacity:.65}
    .tick-label{position:absolute; top:1rem; transform:translateX(-50%); font-size:.8rem; color:#111827; opacity:.7; white-space:nowrap}

    /* Accordéons (details/summary) */
    details.accordion{border:1px solid var(--border); border-radius:12px;}
    details.accordion summary{cursor:pointer; font-weight:700; list-style:none; outline:none; padding:.8rem 1rem;}
    details.accordion summary::-webkit-details-marker{display:none}
    details.accordion summary::after{content:"▸"; float:right; transform:translateY(-1px); opacity:.7; transition: transform .2s;}
    details.accordion[open] summary { border-bottom: 1px solid var(--border); }
    details.accordion[open] summary::after{ transform: rotate(90deg); }
    details.accordion .content{padding: 1rem;}

    .consent{display:flex; gap:.6rem; align-items:flex-start; background:#fffbea; border:1px solid #fde68a; color:#92400e; padding:.55rem .8rem; border-radius:10px}
    .consent input { margin-top: 0.25rem; }
    .note{color:#6b7280; font-size:.92rem; margin-top:.4rem}
    .note strong{color:#374151}
    .small{font-size:.9rem; color:#6b7280}

    footer{padding:1rem 1.5rem; color:#6b7280; font-size:.9rem; background:#fafafa; border-top:1px solid var(--border)}
    
    @media (max-width:640px){
      body{padding:.5rem}
      .section, header, footer{padding:1rem 1.1rem}
      .opts-scale-srs { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="container">
    <header>
      <h1>Échelle de Réciprocité Sociale (SRS)</h1>
      <p class="small" style="color:rgba(255,255,255,0.8); margin-top: 0.25rem;">Version pour Adulte (Rapport par un proche)</p>
      <div class="toolbar">
        <label class="btn" for="file-import">Importer des réponses</label>
        <input type="file" id="file-import" accept=".json" style="display:none"/>
      </div>
    </header>

    <div class="section instructions">
      <p><strong>Ce questionnaire doit être absolument rempli par un adulte de votre entourage ayant vécu avec vous au cours de ces 6 derniers mois</strong> (par exemple votre mère, votre père, votre conjoint, un frère ou une sœur).</p>
      <p style="margin-top:0.5rem;">Pour chaque item, merci de cocher la case qui convient le mieux pour décrire le comportement de la personne au cours des <strong>6 derniers mois</strong>.</p>
    </div>

    <form id="srs-form" class="section">
      <div id="qwrap"></div>
      <div class="actions">
        <button type="submit" class="primary">Calculer le score</button>
        <p id="valmsg" class="validation">Veuillez répondre à toutes les questions en surbrillance.</p>
      </div>
    </form>
    
    <div id="results" class="section" style="display:none;">
      <h2>Résultat</h2>
      <div class="grid">
        <div class="panel">
            <h3>Score Brut Total SRS</h3>
            <div class="bigscore"><span id="total-score">0</span><small>/ 195</small></div>
            
            <div class="barwrap">
              <div class="bar">
                <div id="fill-marker" class="fill-marker" style="left:0%;"></div>
                <div class="tick" style="left:40%"></div><div class="tick-label" style="left:40%">60</div>
                <div class="tick" style="left:50.67%"></div><div class="tick-label" style="left:50.67%">76</div>
              </div>
            </div>

            <details class="accordion" open>
                <summary>Interprétation — Résumé</summary>
                <div class="content">
                  <p id="interp-summary" style="font-weight:500;"></p>
                </div>
            </details>
            
            <details class="accordion" style="margin-top:.6rem">
                <summary>Interprétation détaillée</summary>
                <div class="content">
                    <p id="interp-implication" class="note" style="all:unset;"></p>
                </div>
            </details>

            <p class="note" style="background:var(--warning-bg); border:1px solid var(--warning-border); color:var(--warning-text); padding:.5rem .8rem; border-radius:8px; margin-top:1.5rem;">
              <strong>Avertissement :</strong> Un score plus élevé indique des difficultés plus importantes en termes de réciprocité sociale. Ce résultat est un indicateur et <strong>ne remplace en aucun cas une évaluation par un professionnel qualifié</strong>. Les seuils d'interprétation clinique utilisés ici sont des estimations basées sur la littérature (par ex., Constantino & Gruber, 2012) et ne constituent pas une norme diagnostique formelle.
            </p>
        </div>
        <div class="panel">
            <h3>Exporter vos réponses</h3>
            <p class="small">Aucun stockage local n’est réalisé. Pour conserver une copie de vos réponses et du score, cochez la case de consentement puis cliquez sur « Exporter ».</p>
            <label class="consent" style="margin-top: 1rem;">
              <input type="checkbox" id="consent"/>
              <span>J’atteste avoir obtenu l'autorisation de la personne concernée pour remplir ce questionnaire. Je comprends que je suis responsable de la confidentialité de ce fichier après son exportation.</span>
            </label>
            <div class="actions" style="justify-content:flex-start;">
              <button type="button" id="btn-export" class="btn" disabled>Exporter le résultat</button>
            </div>
        </div>
      </div>
    </div>


    <footer>
      <p><strong>Références :</strong></p>
      <p class="small">Constantino, J. N., & Gruber, C. P. (2012). <em>Social Responsiveness Scale, Second Edition (SRS-2)</em>. Torrance, CA: Western Psychological Services.</p>
      <p style="margin-top:0.5rem;" class="small">© 2012 Western Psychological Services. Tous droits réservés. Cet outil est une adaptation non officielle. L'utilisation commerciale de l'échelle SRS-2 nécessite une licence de Western Psychological Services.</p>
    </footer>
  </div>

  <script>
    const questions = [
        "Semble beaucoup plus nerveux dans des situations sociales que quand il/elle est seul(e).",
        "Son expression faciale n'est pas en harmonie avec le contenu de son discours.",
        "Semble avoir confiance en lui/elle quand il/elle interagit avec les autres.",
        "Quand il/elle est stressé(e), il/elle semble fonctionner en \"pilote automatique\" ou a des patterns de comportements rigides qui paraissent étranges.",
        "Ne réalise pas quand les autres essaient de se servir de lui/elle.",
        "Préfère être seul(e) qu'avec les autres.",
        "Semble être conscient(e) de ce que les autres pensent ou ressentent.",
        "Se comporte de façon étrange ou bizarre.",
        "Semble trop dépendant(e) des autres pour répondre à des besoins basiques.",
        "Interprète les choses de manière trop littérale et ne comprend pas le sens réel des conversations.",
        "A confiance en lui/elle.",
        "Est capable de communiquer ses sentiments aux autres.",
        "Est maladroit(e) dans les interactions impliquant un tour de rôle avec autrui (par exemple, ne semble pas comprendre les tours de parole dans les conversations).",
        "N'est pas bien coordonné(e) dans les activités physiques.",
        "Perçoit et répond de manière appropriée aux changements du ton de la voix ou de l'expression faciale d'autrui.",
        "Évite le contact visuel ou a un contact visuel inhabituel.",
        "Reconnaît lorsque quelque chose est injuste.",
        "A des difficultés à se faire des amis, même quand il/elle fait de son mieux pour essayer.",
        "A des difficultés à transmettre ses idées au cours d'une conversation.",
        "Fait preuve d'intérêts sensoriels inhabituels (comme sentir ses doigts souvent) ou a des manières étranges et répétitives de tenir ou de manipuler de petits objets à portée de main.",
        "Est capable d'imiter les actions des autres et se tient bien quand on le lui demande dans une situation sociale donnée.",
        "Interagit de manière appropriée avec d'autres adultes.",
        "Ne se joint pas aux activités des autres ou aux événements sociaux sauf s'il/elle est forcé(e) à le faire.",
        "A plus de difficulté que les autres à modifier ses routines.",
        "Ne semble pas préoccupé(e) de ne pas être \"en phase\" ou sur la même \"longueur d'onde\" que les autres.",
        "Offre du réconfort aux autres quand ils sont tristes.",
        "Évite d'initier des interactions sociales avec les autres, reste isolé(e).",
        "Pense ou parle de la même chose de manière répétitive.",
        "Considéré(e) par les autres comme étrange ou bizarre.",
        "Est troublé(e) par les situations où il se passe beaucoup de choses en même temps.",
        "Ne peut pas s'arrêter de penser à quelque chose une fois qu'il/elle a commencé.",
        "A une bonne hygiène personnelle.",
        "Est socialement bizarre, même quand il/elle essaie d'être poli(e).",
        "Évite les gens qui veulent être émotionnellement proches de lui/elle.",
        "A du mal à suivre le rythme d'une conversation normale.",
        "A des difficultés à entrer en relation avec les membres de sa famille.",
        "A des difficultés à entrer en relation avec d'autres adultes.",
        "Répond de manière appropriée aux changements d'humeur des autres (par exemple quand l'humeur d'un ami passe de la gaieté à la tristesse).",
        "A des intérêts réduits ou inhabituellement restrictifs.",
        "A de l'imagination (sans perdre le contact avec la réalité).",
        "Saute ; passe d'une activité à l'autre de manière imprévisible.",
        "Semble extrêmement sensible aux sons, aux textures ou aux odeurs.",
        "Est capable de participer au \"bavardage\" (conversation simple avec les autres).",
        "Ne comprend pas comment les événements sont liés les uns aux autres de la même façon que les personnes de son âge (par exemple a du mal à comprendre les causes et les conséquences d'un acte).",
        "Généralement est intéressé(e) par ce que les autres font autour de lui/elle.",
        "A une expression faciale trop sérieuse.",
        "Rit de manière inappropriée.",
        "A le sens de l'humour ; comprend les plaisanteries.",
        "Est extrêmement bon(ne) dans quelques tâches intellectuelles ou informatiques mais a un mauvais niveau dans la plupart des autres tâches.",
        "A des comportements étranges répétitifs.",
        "A des difficultés à répondre aux questions directement et finit par tourner autour du sujet.",
        "Sait quand il/elle parle trop fort ou fait trop de bruit.",
        "Parle aux personnes avec une tonalité vocale inhabituelle (par exemple comme un robot ou comme s'il/elle donnait un cours).",
        "Semble traiter les gens comme s'ils étaient des objets.",
        "Se rend compte quand il/elle est trop proche ou quand il/elle envahit l'espace d'autrui.",
        "Marche entre deux personnes qui sont en train de parler.",
        "Isolé(e) ; a tendance à ne pas quitter sa maison.",
        "Se concentre trop sur des parties d'objets au lieu de voir la totalité de l'objet.",
        "Trop soupçonneux(se).",
        "Est émotionnellement distant(e), ne montre pas ses émotions.",
        "Est inflexible, ne change que très rarement d'avis.",
        "Donne des raisons inhabituelles ou illogiques pour faire des choses.",
        "Touche ou accueille les autres de manière inadaptée.",
        "Est trop tendu(e) dans les situations sociales.",
        "Fixe les gens intensément ou ne dirige pas son regard vers le centre d'attention."
    ];
    const responses = [
        {label:"Pas VRAI", value:0}, 
        {label:"Parfois VRAI", value:1}, 
        {label:"Souvent VRAI", value:2}, 
        {label:"Presque toujours VRAI", value:3}
    ];

    const positiveItems = [1, 4, 6, 8, 10, 13, 14, 16, 18, 19, 20, 23, 24, 25, 27, 28, 29, 30, 31, 33, 34, 35, 36, 37, 39, 41, 42, 46, 47, 50, 51, 53, 54, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65];
    const invertedItems = [2, 3, 5, 7, 9, 11, 12, 15, 17, 21, 22, 26, 38, 40, 43, 45, 48, 49, 52, 55];

    // --- Génération du formulaire ---
    const qwrap = document.getElementById('qwrap');
    questions.forEach((qText, i) => {
      const idx = i + 1;
      const div = document.createElement('div');
      div.className = 'question';
      div.id = `q-container-${idx}`;
      const opts = responses.map(r => `<div><input type="radio" id="q${idx}_${r.value}" name="q${idx}" value="${r.value}"/><label for="q${idx}_${r.value}">${r.label}</label></div>`).join('');
      div.innerHTML = `<div class="qtext">${idx}. ${qText}</div><div class="opts-scale-srs">${opts}</div>`;
      qwrap.appendChild(div);
    });
    
    // --- Interprétation ---
    function getScoreInterpretation(score) {
        if (score >= 76) return { 
            level: "Sévère", 
            color: "var(--primary)", 
            summary: `Le score de ${score} est au-dessus du seuil de 76, suggérant un niveau de difficultés dans la réciprocité sociale <strong>très élevé</strong>.`,
            implication: `<strong>Interprétation détaillée :</strong> Un score élevé indique que la personne présente des difficultés importantes et observables dans la communication, l'interaction sociale et la flexibilité comportementale. La recherche sur l'échelle SRS (par ex., Constantino & Gruber, 2012) montre une corrélation forte entre un score élevé et les traits caractéristiques du trouble du spectre de l'autisme (TSA).<br><br><strong>Le seuil de 76 :</strong> Ce score n'est pas un diagnostic, mais un repère clinique. Un score ≥ 76 indique un niveau de difficultés qui justifie fortement une évaluation diagnostique complète, en raison de son lien démontré avec des altérations significatives du fonctionnement social.`
        };
        if (score >= 60) return { 
            level: "Léger à Modéré", 
            color: "var(--primary)",
            summary: `Le score de ${score} se situe dans la plage <strong>légère à modérée</strong>, indiquant la présence de difficultés socialement significatives.`,
            implication: `<strong>Interprétation détaillée :</strong> Un score dans cette plage indique que la personne manifeste des comportements sociaux atypiques qui peuvent affecter les relations au quotidien. Bien que les difficultés soient moins sévères, elles peuvent néanmoins représenter un défi important et nécessiter des stratégies d'adaptation.<br><br><strong>Le seuil de 60 :</strong> Ce score est un indicateur clinique qui suggère que les traits observés, bien que légers à modérés, peuvent justifier une attention particulière ou une évaluation plus approfondie pour mieux comprendre ces défis et explorer des stratégies de soutien.`
        };
        return { 
            level: "Dans la norme", 
            color: "var(--primary)",
            summary: `Le score de ${score} se situe <strong>dans la norme</strong>, ne suggérant pas de difficultés cliniquement significatives en matière de réciprocité sociale.`,
            implication: `<strong>Interprétation détaillée :</strong> Un score dans cette plage indique un développement social typique. Cela n'exclut pas la présence de défis sociaux occasionnels ou d'autres problématiques (par exemple, l'anxiété sociale), mais ne pointe pas vers un déficit global et persistant de la réciprocité sociale tel que mesuré par le SRS.`
        };
    }

    // --- Calcul et affichage ---
    const form = document.getElementById('srs-form');
    const resultsDiv = document.getElementById('results');
    const totalScoreEl = document.getElementById('total-score');
    const valmsg = document.getElementById('valmsg');
    const interpSummaryEl = document.getElementById('interp-summary');
    const interpImplicationEl = document.getElementById('interp-implication');
    const fillMarker = document.getElementById('fill-marker');


    form.addEventListener('submit', (e) => {
        e.preventDefault();
        const fd = new FormData(form);
        const answers = {};
        for (const [k, v] of fd.entries()) {
            answers[k] = parseInt(v, 10);
        }

        let allAnswered = true;
        for (let i = 1; i <= questions.length; i++) {
            const qContainer = document.getElementById(`q-container-${i}`);
            if (answers[`q${i}`] === undefined) {
                qContainer.classList.add('missing');
                allAnswered = false;
            } else {
                qContainer.classList.remove('missing');
            }
        }

        if (!allAnswered) {
            valmsg.style.display = 'block';
            resultsDiv.style.display = 'none';
            const firstMissing = document.querySelector('.question.missing');
            if (firstMissing) firstMissing.scrollIntoView({ behavior: 'smooth', block: 'center' });
            return;
        }
        valmsg.style.display = 'none';

        let totalScore = 0;
        for (let i = 1; i <= questions.length; i++) {
            const value = answers[`q${i}`];
            if (invertedItems.includes(i)) {
                totalScore += (3 - value);
            } else {
                totalScore += value;
            }
        }

        // Affichage
        const interp = getScoreInterpretation(totalScore);
        totalScoreEl.textContent = totalScore;
        totalScoreEl.style.color = interp.color;
        
        const maxVisualScore = 150; // On borne pour une meilleure visualisation
        const markerPercent = Math.max(0, Math.min(100, (totalScore / maxVisualScore) * 100));
        fillMarker.style.left = `${markerPercent}%`;
        
        interpSummaryEl.innerHTML = interp.summary;
        interpImplicationEl.innerHTML = interp.implication;

        resultsDiv.style.display='block';
        resultsDiv.scrollIntoView({behavior:'smooth'});
        document.getElementById('btn-export').disabled = !document.getElementById('consent').checked;
    });

    // --- Import/Export ---
    const fileImport = document.getElementById('file-import');
    fileImport.addEventListener('change', (ev) => {
      const f = ev.target.files?.[0]; if (!f) return;
      const reader = new FileReader();
      reader.onload = (e) => {
        try {
          const data = JSON.parse(e.target.result);
          const answersToLoad = data.answers || data;

          for (let i = 1; i <= questions.length; i++) {
            const v = answersToLoad[`q${i}`];
            if (v !== undefined) {
              const r = document.querySelector(`input[name="q${i}"][value="${v}"]`);
              if (r) r.checked = true;
            }
          }
          form.dispatchEvent(new Event('submit', { cancelable: true }));
        } catch { alert("Fichier invalide."); }
        finally { ev.target.value = ''; }
      };
      reader.readAsText(f);
    });

    const consent = document.getElementById('consent');
    const btnExport = document.getElementById('btn-export');
    consent.addEventListener('change', () => {
        if (resultsDiv.style.display === 'block') {
            btnExport.disabled = !consent.checked;
        }
    });

    btnExport.addEventListener('click', () => {
      if (!consent.checked) return;
      const fd = new FormData(form);
      const answers = {};
      for (const [k, v] of fd.entries()) answers[k] = v;

      if (Object.keys(answers).length < questions.length) { 
          alert("Veuillez d’abord répondre à toutes les questions et calculer un résultat."); 
          return; 
      }
      
      const resultData = {
          score: totalScoreEl.textContent,
          interpretation: getScoreInterpretation(parseInt(totalScoreEl.textContent, 10)).level,
          answers: answers,
          date: new Date().toISOString()
      };

      const blob = new Blob([JSON.stringify(resultData, null, 2)], {type: 'application/json'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = `resultat_srs_adulte_${resultData.date.split('T')[0]}.json`;
      document.body.appendChild(a); a.click(); document.body.removeChild(a); URL.revokeObjectURL(url);
    });
  </script>
</body>
</html>





